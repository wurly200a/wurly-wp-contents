#+BLOG: wurly-blog
#+POSTID: 1104
#+ORG2BLOG:
#+DATE: [2024-02-11 Sun 18:04]
#+OPTIONS: toc:nil num:nil todo:nil pri:nil tags:nil ^:nil
#+CATEGORY: Kubernetes
#+TAGS: 
#+DESCRIPTION:
#+TITLE: kind (Kubernetes in Docker) ã§ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’ä½œæˆ

* ã¯ã˜ã‚ã«

kind ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ 0.20.0 ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

* ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ç”Ÿæˆã¨ç ´æ£„

** è¦å®š(default)ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã®ç”Ÿæˆ
 - [[https://kind.sigs.k8s.io/docs/user/quick-start/][kind â€“ Quick Start]]
https://kind.sigs.k8s.io/docs/user/quick-start/

#+begin_src bash
kind create cluster
#+end_src

#+begin_src bash
$ kind create cluster
Creating cluster "kind" ...
 âœ“ Ensuring node image (kindest/node:v1.27.3) ğŸ–¼
 âœ“ Preparing nodes ğŸ“¦  
 âœ“ Writing configuration ğŸ“œ 
 âœ“ Starting control-plane ğŸ•¹ï¸ 
 âœ“ Installing CNI ğŸ”Œ 
 âœ“ Installing StorageClass ğŸ’¾ 
Set kubectl context to "kind-kind"
You can now use your cluster with:

kubectl cluster-info --context kind-kind

Not sure what to do next? ğŸ˜…  Check out https://kind.sigs.k8s.io/docs/user/quick-start/
#+end_src

#+begin_src bash
$ kubectx
kind-kind
#+end_src

#+begin_src bash
$ kubectl get nodes
NAME                 STATUS   ROLES           AGE   VERSION
kind-control-plane   Ready    control-plane   85s   v1.27.3
#+end_src

#+begin_src bash
$ kubectl get pod -A
NAMESPACE            NAME                                         READY   STATUS    RESTARTS   AGE
kube-system          coredns-5d78c9869d-rzkp5                     1/1     Running   0          104s
kube-system          coredns-5d78c9869d-z7hzw                     1/1     Running   0          104s
kube-system          etcd-kind-control-plane                      1/1     Running   0          118s
kube-system          kindnet-hczpj                                1/1     Running   0          105s
kube-system          kube-apiserver-kind-control-plane            1/1     Running   0          2m
kube-system          kube-controller-manager-kind-control-plane   1/1     Running   0          119s
kube-system          kube-proxy-hgfdd                             1/1     Running   0          105s
kube-system          kube-scheduler-kind-control-plane            1/1     Running   0          118s
local-path-storage   local-path-provisioner-6bc4bddd6b-6gqg6      1/1     Running   0          104s
#+end_src

#+begin_src bash
kind delete cluster
#+end_src

#+begin_src bash
Deleting cluster "kind" ...
Deleted nodes: ["kind-control-plane"]
#+end_src

** ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³3å°ã€ãƒ¯ãƒ¼ã‚«ãƒ¼3å°

 - https://github.com/MasayaAoyama/kubernetes-perfect-guide/blob/2nd-edition/samples/chapter03/kind.yaml

ä¸Šè¨˜ã‚’ç”¨ã„ã¦è©¦ã—ã¦ã¿ã¾ã—ãŸãŒã€v1.18.2 ã§ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã£ãŸãŸã‚ã€v1.27.3 ã¨ã—ãŸã¨ã“ã‚ç”Ÿæˆã§ãã¾ã—ãŸã€‚

kind.yaml

#+begin_src yaml
apiVersion: kind.x-k8s.io/v1alpha4
kind: Cluster
nodes:
- role: control-plane
  image: kindest/node:v1.27.3
- role: control-plane
  image: kindest/node:v1.27.3
- role: control-plane
  image: kindest/node:v1.27.3
- role: worker
  image: kindest/node:v1.27.3
- role: worker
  image: kindest/node:v1.27.3
- role: worker
  image: kindest/node:v1.27.3
#+end_src

#+begin_src bash
$ kind create cluster --config kind.yaml --name kindcluster
#+end_src

#+begin_src bash
Creating cluster "kindcluster" ...
 âœ“ Ensuring node image (kindest/node:v1.27.3) ğŸ–¼
 âœ“ Preparing nodes ğŸ“¦ ğŸ“¦ ğŸ“¦ ğŸ“¦ ğŸ“¦ ğŸ“¦  
 âœ“ Configuring the external load balancer âš–ï¸ 
 âœ“ Writing configuration ğŸ“œ 
 âœ“ Starting control-plane ğŸ•¹ï¸ 
 âœ“ Installing CNI ğŸ”Œ 
 âœ“ Installing StorageClass ğŸ’¾ 
 âœ“ Joining more control-plane nodes ğŸ® 
 âœ“ Joining worker nodes ğŸšœ 
Set kubectl context to "kind-kindcluster"
You can now use your cluster with:

kubectl cluster-info --context kind-kindcluster

Have a question, bug, or feature request? Let us know! https://kind.sigs.k8s.io/#community ğŸ™‚
#+end_src


#+begin_src 
$ k get nodes
NAME                         STATUS   ROLES           AGE     VERSION
kindcluster-control-plane    Ready    control-plane   3m      v1.27.3
kindcluster-control-plane2   Ready    control-plane   2m48s   v1.27.3
kindcluster-control-plane3   Ready    control-plane   117s    v1.27.3
kindcluster-worker           Ready    <none>          112s    v1.27.3
kindcluster-worker2          Ready    <none>          112s    v1.27.3
kindcluster-worker3          Ready    <none>          114s    v1.27.3
#+end_src

#+begin_src bash
$ k get pod -A
NAMESPACE            NAME                                                 READY   STATUS    RESTARTS
kube-system          coredns-5d78c9869d-89g8s                             1/1     Running   0       
kube-system          coredns-5d78c9869d-sgtr5                             1/1     Running   0       
kube-system          etcd-kindcluster-control-plane                       1/1     Running   0       
kube-system          etcd-kindcluster-control-plane2                      1/1     Running   0       
kube-system          etcd-kindcluster-control-plane3                      1/1     Running   0       
kube-system          kindnet-4trxn                                        1/1     Running   0       
kube-system          kindnet-9x6lf                                        1/1     Running   0       
kube-system          kindnet-fqkzc                                        1/1     Running   0       
kube-system          kindnet-m687n                                        1/1     Running   0       
kube-system          kindnet-sjm4s                                        1/1     Running   0       
kube-system          kindnet-wn67h                                        1/1     Running   0       
kube-system          kube-apiserver-kindcluster-control-plane             1/1     Running   0       
kube-system          kube-apiserver-kindcluster-control-plane2            1/1     Running   0       
kube-system          kube-apiserver-kindcluster-control-plane3            1/1     Running   1 (2m34s
kube-system          kube-controller-manager-kindcluster-control-plane    1/1     Running   1 (3m8s 
kube-system          kube-controller-manager-kindcluster-control-plane2   1/1     Running   0       
kube-system          kube-controller-manager-kindcluster-control-plane3   1/1     Running   0       
kube-system          kube-proxy-89vbv                                     1/1     Running   0       
kube-system          kube-proxy-cp8rv                                     1/1     Running   0       
kube-system          kube-proxy-h68wd                                     1/1     Running   0       
kube-system          kube-proxy-mnlm6                                     1/1     Running   0       
kube-system          kube-proxy-ms45k                                     1/1     Running   0       
kube-system          kube-proxy-msvbd                                     1/1     Running   0       
kube-system          kube-scheduler-kindcluster-control-plane             1/1     Running   1 (3m3s 
kube-system          kube-scheduler-kindcluster-control-plane2            1/1     Running   0       
kube-system          kube-scheduler-kindcluster-control-plane3            1/1     Running   0       
local-path-storage   local-path-provisioner-6bc4bddd6b-jxksg              1/1     Running   0       
#+end_src

* ãŠã‚ã‚Šã«

ä»¥ä¸Šã§ã™ã€‚

